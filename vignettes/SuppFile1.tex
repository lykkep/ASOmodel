% !TEX TS-program = pdflatexmk
\documentclass[a4paper,11pt]{article}

\usepackage{Temp_short}
\usepackage[bottom]{footmisc}
\usepackage{commath}
\setlength{\jot}{0.3cm}
\allowdisplaybreaks[2]

\newenvironment{Ncenter}{%
  \setlength\topsep{-10pt}
  \setlength\parskip{-100pt}
  \begin{center}
}{%
  \end{center}
}

\bibliographystyle{abbrv}

\newcommand{\kmo}{k_{OT \to O+T}}
\newcommand{\ko}{k_{O+T \to OT}}
\newcommand{\kmt}{k_{OTE \to OT+E}}
\newcommand{\kt}{k_{OT+E \to OTE}}
\newcommand{\kc}{k_{OT+E \to OTE}}
\newcommand{\kE}{k_{OTE \to OCE}}
\newcommand{\kD}{k_{*C \to *+C}}
\newcommand{\vp}{v_{\mathrm{prod}}}
\newcommand{\vd}{v_{\mathrm{degrad}}}
\newcommand{\Trel}{T_{\rm{rel}}}
\newcommand{\Trelmin}{T_{\rm{rel,min}}}

\makeatletter 
\renewcommand{\thefigure}{S\@arabic\c@figure}
\renewcommand{\thesection}{S\@arabic\c@section}
\renewcommand{\thetable}{S\@arabic\c@table}
\addto\captionsenglish{\renewcommand{\figurename}{Supplementary Figure}}
\addto\captionsenglish{\renewcommand{\tablename}{Supplementary Table}}

\title{Supplementary File S1 for Pedersen et al. (2013), Nature Biotechnology}
\author{Lykke Pedersen, \and Peter H Hagedorn, \and Marie Lindholm, \and Morten Lindow}
\date{}

\usepackage{Sweave}
\begin{document}
\input{SuppFile1-concordance}
\maketitle

This document is the supplementary file for the manuscript entitled ``A kinetic model of enzyme recruiting oligonucleotides predicts an optimal affinity and thus explains why shorter and less affine oligonucleotides may be more potent" (2013) and it is a vignette for the R-package ASOmodel.

The functions and data used to produce the figures in the main manuscript and this supplementary file are available after installing and requiring the ASOmodel package in R
\begin{Schunk}
\begin{Sinput}
> require(devtools)
> install_github('ASOmodel',username='lykkep')
> require(ASOmodels)
\end{Sinput}
\end{Schunk}
The ASOmodels package contains the following functions:
\begin{enumerate}
\item \texttt{Trel}
\item \texttt{TrelNO}
\item \texttt{Trelstoc}
\item \texttt{plot.doseresponse}
\item \texttt{IC50}
\item \texttt{IC50NO}
\item \texttt{IC50stoc}
\item \texttt{diffASO}
\item \texttt{pretty10expLP}
\end{enumerate}

\newpage

\tableofcontents

\section{The rate-equations of the ASO model}
The kinetic ASO model governs seven ODEs for the seven variables: free target ($T$), free oligonucleotide ($O$), free RNAse H ($E$), complex of oligonucleotide and target ($OT$), complex of oligonucleotide, target and RNAse H  ($OTE$), complex of cleaved target, oligonucleotide and RNase H ($OCE$), and complex of cleaved target and oligonucleotide  ($OC$). The ASO model is described by the seven equations
\begin{align}
%T
\frac{\dif [T]}{\dif t} &= \vp - \vd [T]-k_{O+T \to OT} [T] [O] +k_{OT\to O+T } [OT] \\
%OT
\frac{\dif [OT]}{\dif t} &= \ko[O][T]-\kmo[OT] \nonumber \\
	& \quad -\kt[OT][E]+\kmt [OTE]-\vd[OT] \\
%OTE
\frac{\dif [OTE]}{\dif t} &= \kt[E][OT]-\kmt[OTE] \nonumber \\
	& \quad -(\vd+\kE)[OTE]\\
%E
\frac{\dif [E]}{\dif t} &= -\kt[E][OT]+\kmt([OTE]+[OCE]) \nonumber \\
	& \quad+\vd[OTE]\\
%O
\frac{\dif [O]}{\dif t}&= \kmo [OT]-\ko[O][T] \nonumber \\
	& \quad +\kD [OC]+\vd([OT]+[OTE])  \\
%ODE
\frac{\dif [OCE]}{\dif t}& = \kE [OTE]-\kmt [OCE]\\
%OD
\frac{\dif [OC]}{\dif t}& = \kmt [OCE]-\kD [OC]
\end{align}
Complex formation and breaking are denoted by rate constants $k$ with subscripts. Target production and degradation rates are denoted by $\vp$ and $\vd$, respectively. The default parameter values are listed in Supplementary Table~\ref{tb::par}.


Steady-state is reached when the Eqs.~(1)-(7) are equated to zero. Using Maple16 the steady-state concentrations are found. They all depend on the roots to a fourth order polynomial with coefficients calculated within the R-function \texttt{Trel()}. The one root that ensures that all concentrations are non-negative and also fullfills that
\begin{align*}
 &[O]+[OTE]+[OT]+[OCE]+[OC] = O_t \quad \mathrm{and}\\ 
 &[OTE]+[OCE]+[E] = E_t \enspace,
\end{align*}
is chosen. 

%Trel
When there is no oligonucleotide added to the system, then the steady-state concentration of target is $[T]=\frac{\vp}{ \vd}$. When oligonucleotide is added to the system then the total concentration of target at steady-state is the sum of the concentrations $[T]$, $[OT]$ and $[OTE]$. The relative total target concentration at steady-state is then calculated as 
\begin{equation}
\Trel = \frac{[T]+[OT]+[OTE]}{\frac{\vp}{ \vd}} \enspace.
\end{equation}

%IC50
The half maximal inhibitory concentration ($IC_{50}$) is the concentration of total nucleotide needed to inhibit the target concentration by half. The $IC_{50}$ is a measure of the potency of an oligonucleotide. A more potent oligonucleotide will have a lower $IC_{50}$ value. In mathematical terms the $IC_{50}$ value is defined as
\begin{equation}
IC_{50} = \left(O_t \left|\, \Trel = \frac{\mathrm{Eff}}{2}+\Trelmin \right.\right)  \enspace, \label{eq::IC50}
\end{equation}
where the efficacy (Eff, the maximum decrease in $\Trel$), and the minimum value of $\Trel$ ($\Trelmin$) are defined by
\begin{equation}
\textrm{Eff}=1-\lim_{O_t \to \infty} \Trel =1 - \Trelmin \label{eq:Eff} \enspace.
\end{equation}


\newpage
\section{Supplementary Table S1}
\begin{table}[!h]
\caption{Default values for the parameter-space of the ASO model. Concentrations are measured in nM and time in min.}\label{tb::par}
\setlength\extrarowheight{5pt}  %Increases the height of each row
\begin{tabular}{| l | l | r | l |}
\hline
Parameter & Description &Default value & Ref  \\
\hline
$E_t$ & Total RNAse H concentration & 1 nM & Ref. \cite{Amirkhanov:2002vo}\\
$O_t$ & Total oligonucleotide conc & $\mathcal{O}(\mu M )$ & {}\\
$v_{prod}$ & Production of target & 0.2 nM/min & Ref. \cite{lodish2008molecular}\\
$v_{degrad}$ & Degradation of target & 0.04 $\rm{min}^{-1}$ & Ref. \cite{Yang:2003ja}\\
$D_{OT}$ & Dissociation constant of $OT$ & 0.3 nM & Ref. \cite{Christensen:2001te} \\
$D_{OTE}$ & Dissociation constant of $OTE$  & 70 nM & Ref. \cite{Amirkhanov:2002vo} \\
$k_{O+T \to OT }$ & Rate of $O+T \to OT$ & $0.2 \, (\rm{nM \,min})^{-1}$ & Ref. \cite{Christensen:2001te}\\
$k_{OT+E \to OTE}$ & Rate of $OT+E \to OTE$  & 5 $(\rm{nM \,min})^{-1}$ & Ref. \cite{Amirkhanov:2002vo}\\
$k_{OTE \to OCE}$ & Rate of cleavage  & 8 $\rm{min}^{-1}$ & Ref. \cite{Amirkhanov:2002vo}\\
$\alpha$ & Ratio of $\frac{k_{OT \to O+T}}{k_{\mathrm{*C \to *+C}}} \le 1$ & 0.1  & {}\\
\hline
\end{tabular}
\end{table}
%%%%



\section{Supplementary Figure S1}
The R-function \texttt{Trel()} calculates $\Trel$ and takes $O_t$ and the set of parameters as input:
\begin{Schunk}
\begin{Sinput}
> #The parameters are in vector-format
> parms <- c(Et = 1,KdOT = 0.3,kOpT = 0.2,KdOTE = 70,kOTpE = 5,	
+            vprod = 0.2,vdegrad = 0.04,alpha=0.1,kcleav = 8)
> Trel(Ot=1,param=parms)